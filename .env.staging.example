# ============================================================================
# På Spåret Party Edition — Staging Environment Configuration
# ============================================================================
#
# This file contains example environment variables for staging deployment.
# Copy this file and replace placeholder values with actual staging values.
#
# Security Note:
# - NEVER commit actual secrets to git
# - Use platform-specific secret management (Railway secrets, Vercel env vars)
# - Rotate JWT_SECRET between environments (dev/staging/production)
#
# ============================================================================

# ──────────────────────────────────────────────────────────────────────────
# BACKEND (services/backend/) — Railway / Render / Fly.io
# ──────────────────────────────────────────────────────────────────────────

# Server Configuration
PORT=3000
NODE_ENV=staging

# Public-Facing URL
# Replace with your actual Railway/Render URL after first deployment
# Example: https://pa-sparet-backend-staging-abc123.up.railway.app
PUBLIC_BASE_URL=https://<your-railway-app>.up.railway.app

# Authentication (JWT)
# Generate a strong secret with: openssl rand -base64 32
# MUST be unique for staging (different from dev/production)
JWT_SECRET=REPLACE_WITH_STRONG_RANDOM_SECRET_32_CHARS_MINIMUM

# CORS Configuration
# Add all allowed origins (comma-separated, no trailing slashes)
# Include: Vercel web player URL, custom domains, localhost (for testing)
# Example: https://pa-sparet-web-staging.vercel.app,https://play-staging.example.com
ALLOWED_ORIGINS=https://<your-vercel-app>.vercel.app

# Logging
# Options: debug, info, warn, error
# Use 'debug' for staging, 'info' for production
LOG_LEVEL=info

# AI Content Service (Optional)
# Leave blank to use mock mode (backend handles fallback gracefully)
# If deploying ai-content service to Railway, set URL here
# Example: https://pa-sparet-ai-content-staging.up.railway.app
AI_CONTENT_URL=

# ──────────────────────────────────────────────────────────────────────────
# WEB PLAYER (apps/web-player/) — Vercel / Netlify / Cloudflare Pages
# ──────────────────────────────────────────────────────────────────────────

# Backend API Base URL
# Replace with your Railway backend URL (from PUBLIC_BASE_URL above)
# MUST be HTTPS (not HTTP) for WebSocket to work over secure origin
# Example: https://pa-sparet-backend-staging-abc123.up.railway.app
VITE_API_BASE_URL=https://<your-railway-app>.up.railway.app

# ──────────────────────────────────────────────────────────────────────────
# iOS HOST APP (apps/ios-host/) — Xcode Build Configuration
# ──────────────────────────────────────────────────────────────────────────

# Backend URL (hardcoded in Swift or loaded from Config.swift)
# Set this in Xcode build settings or Swift config file:
# BASE_URL=https://<your-railway-app>.up.railway.app

# ──────────────────────────────────────────────────────────────────────────
# tvOS APP (apps/tvos/) — Xcode Build Configuration
# ──────────────────────────────────────────────────────────────────────────

# Backend URL (same as iOS Host)
# BASE_URL=https://<your-railway-app>.up.railway.app

# ──────────────────────────────────────────────────────────────────────────
# AI CONTENT SERVICE (services/ai-content/) — Optional for Staging
# ──────────────────────────────────────────────────────────────────────────

# Server Configuration
# PORT=3001
# NODE_ENV=staging

# ElevenLabs API (TTS Generation)
# Get API key from: https://elevenlabs.io/app/settings/api-keys
# ELEVENLABS_API_KEY=your_elevenlabs_api_key_here

# OpenAI API (AI Content Generation) — Future
# OPENAI_API_KEY=your_openai_api_key_here

# ──────────────────────────────────────────────────────────────────────────
# DEPLOYMENT CHECKLIST
# ──────────────────────────────────────────────────────────────────────────

# Backend (Railway):
# [ ] Replace PUBLIC_BASE_URL with Railway-assigned URL
# [ ] Generate and set JWT_SECRET (openssl rand -base64 32)
# [ ] Update ALLOWED_ORIGINS with Vercel web player URL
# [ ] Verify LOG_LEVEL is set to 'info' or 'debug'
# [ ] Deploy and test /health endpoint

# Web Player (Vercel):
# [ ] Set VITE_API_BASE_URL to Railway backend URL
# [ ] Deploy and test connection to backend
# [ ] Verify HTTPS (no mixed content warnings)

# iOS/tvOS (Xcode):
# [ ] Update BASE_URL in Config.swift to Railway URL
# [ ] Create 'Staging' build configuration
# [ ] Archive and upload to TestFlight
# [ ] Test on physical device

# Post-Deployment:
# [ ] Test end-to-end flow (create session → join → play → reconnect)
# [ ] Verify WebSocket connection stability
# [ ] Monitor Railway logs for errors
# [ ] Test on multiple devices/browsers

# ──────────────────────────────────────────────────────────────────────────
# SECURITY REMINDERS
# ──────────────────────────────────────────────────────────────────────────

# 1. JWT_SECRET must be:
#    - Minimum 32 characters
#    - Cryptographically random (use openssl or similar)
#    - Unique per environment (dev ≠ staging ≠ production)
#    - NEVER committed to git

# 2. ALLOWED_ORIGINS must be:
#    - Specific domains (no wildcards in production)
#    - HTTPS only (no HTTP in production/staging)
#    - No trailing slashes

# 3. PUBLIC_BASE_URL must be:
#    - HTTPS (for secure QR codes)
#    - Match Railway/Render assigned domain

# 4. ElevenLabs API Key:
#    - Keep secret (rate limits apply)
#    - Monitor usage in ElevenLabs dashboard
#    - Set spending limits to avoid overages

# ──────────────────────────────────────────────────────────────────────────
# EXAMPLE STAGING VALUES (Replace with actual values)
# ──────────────────────────────────────────────────────────────────────────

# Backend:
# PUBLIC_BASE_URL=https://pa-sparet-backend-staging.up.railway.app
# JWT_SECRET=Xk7Qp2Lm9Rt4Vw8Yb5Nd1Hf6Jz3Sc0Ga2Uq4Xe7Io=
# ALLOWED_ORIGINS=https://pa-sparet-web-staging.vercel.app,https://localhost:5173

# Web Player:
# VITE_API_BASE_URL=https://pa-sparet-backend-staging.up.railway.app

# ──────────────────────────────────────────────────────────────────────────
# END OF STAGING CONFIGURATION EXAMPLE
# ──────────────────────────────────────────────────────────────────────────
